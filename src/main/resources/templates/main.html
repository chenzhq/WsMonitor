<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<html>
	<head>
		<meta charset="UTF-8">
		<title>监控系统</title>
		<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
		<script src="../static/js/semantic.js" th:src="@{/js/semantic.js}"></script>
		<link rel="stylesheet" href="../static/css/semantic.css" th:href="@{/css/semantic.css}"  />
		<link rel="stylesheet" href="../static/css/icon.css" th:href="@{/css/icon.css}" />
		<!-- 引入 echarts.js -->
		<script src="../static/js/echarts.min.js" th:src="@{/js/echarts.min.js}"></script>
		<!-- 引入 ajax异步请求，模拟服务器地址 -->
		<script src="http://rapapi.org/rap.plugin.js?projectId=19544"></script>
	</head>

	<body>
		<div class="ui segment">

			<div class="ui three column grid" style="margin-top: -60px;margin-bottom: -70px">
				<div class="column">
					<div id="main0" style="height: 300px"></div>
				</div>
				<div class="column">
					<div id="main1" style="height: 300px"></div>
				</div>
				<div class="column">
					<div id="main2" style="height: 300px"></div>
				</div>
			</div>

			<h3>
				<i class="bar chart icon"></i>
				最近的20个问题
			</h3>
			<table class="ui small table">
				<thead>
				<tr >
					<th>主机</th>
					<th>问题</th>
					<th>上次修改于</th>
					<th>历时</th>
					<th>确认</th>
				</tr></thead>
				<tbody>
				<tr >
					<td>
						<div class="ui ribbon label">主机1</div>
					</td>
					<td>主机1内存使用率超过90%</td>
					<td>2017-4-27 15:33:20</td>
					<td><p>2天4小时50分</p></td>
					<td><button >不</button></td>
				</tr>
				<tr >
					<td>主机1</td>
					<td>主机1内存使用率超过90%</td>
					<td>2017-4-27 15:33:20</td>
					<td><p>2天4小时50分</p></td>
					<td><button >不</button></td>
				</tr>
				<tr >
					<td>主机1</td>
					<td>主机1内存使用率超过90%</td>
					<td>2017-4-27 15:33:20</td>
					<td><p>2天4小时50分</p></td>
					<td><button >不</button></td>
				</tr>
				<tr >
					<td>主机1</td>
					<td>主机1内存使用率超过90%</td>
					<td>2017-4-27 15:33:20</td>
					<td><p>2天4小时50分</p></td>
					<td><button >不</button></td>
				</tr>
				<tr>
					<td>主机1</td>
					<td>主机1内存使用率超过90%</td>
					<td>2017-4-27 15:33:20</td>
					<td><p>2天4小时50分</p></td>
					<td><button >不</button></td>
				</tr>
				</tbody>
				<tfoot>
				<tr><th colspan="5">
					<div class="ui mini right teal floated pagination menu">
						<a class="icon item">
							<i class="left chevron icon"></i>
						</a>
						<a class="item">1</a>
						<a class="item">2</a>
						<a class="item">3</a>
						<a class="item">4</a>
						<a class="icon item">
							<i class="right chevron icon"></i>
						</a>
					</div>
				</th>
				</tr></tfoot>
			</table>
		</div>
			<!-- 主内容结束-->
			<script type="text/javascript">
				// 基于准备好的dom，初始化echarts实例
				var myChart = echarts.init(document.getElementById('main0'));
				// 指定图表的配置项和数据
				var option = {
						title: {
									text: '10个',
									subtext: '业务系统 ',
									x: 'center',
									y: 'center',
									itemGap: 10,
									textStyle : {
										color : '#01AAED',
										fontFamily : '微软雅黑',
										fontSize : 24,
										fontWeight : 'bolder'
									}
								},
						tooltip : {
									trigger: 'item',
									formatter: "{a} <br/>{b} : {c} ({d}%)"
								},
						series: [
							{
								name:'访问来源',
								type:'pie',
								radius: ['40%', '60%'],
								itemStyle: {  
									normal: {  
									 label:{  
											show: true,  
											formatter: function(param) {
												 return param.name + param.value + "个" + ':\n' + Math.round(param.percent) + '%';
											},
											textStyle : {
												fontWeight : 'bolder'
											}
										}   
									},
								 },
                                data: [
                                    {value:335, name:'危险'},
                                    {value:310, name:'故障'},
                                    {value:234, name:'正常'},
                                    {value:135, name:'未知'},
								],
								color:['#FF5722','#F7B824','#5FB878','#d2d2d2','#2F4056']
							}
						]
					};
		
				// 使用刚指定的配置项和数据显示图表。
				myChart.setOption(option);

                /*myChart.showLoading();  */  //数据加载完之前先显示一段简单的loading动画
                $.ajax({
                    type: "post",
                    async: true,            //异步请求（同步请求将会锁住浏览器，用户其他操作必须等待请求完成才可以执行）
                    url: "/host/count",
                    data: {},
                    dataType: "json",        //返回数据形式为json
                    success: function (result) {
                        var seriesdata = [];
                        var data=result.data;
                        var dataList=data.stateNum;
                        var total=data.totalNum;
                        var str=JSON.stringify(dataList);
                        //alert(str+total);
                        if(dataList){
                            option.title.text = total;
                            option.series[0].data = dataList;
                            myChart.setOption(option);
                        }
                    },
                    error: function (errorMsg) {
                        //请求失败时执行该函数
                        alert("图表请求数据失败!");
                        myChart.hideLoading();
                    }
                })
				</script>
                <script type="text/javascript">
				// 基于准备好的dom，初始化echarts实例
				var myChart = echarts.init(document.getElementById('main1'));
		
				// 指定图表的配置项和数据
				var option = {
						title: {
									text: '1014个',
									subtext: '监控点',
									x: 'center',
									y: 'center',
									itemGap: 10,
									textStyle : {
										color : '#01AAED',
										fontFamily : '微软雅黑',
										fontSize : 24,
										fontWeight : 'bolder'
									}
								},
						tooltip : {
									trigger: 'item',
									formatter: "{a} <br/>{b} : {c} ({d}%)"
								},
						series: [
							{
								name:'访问来源',
								type:'pie',
								radius: ['40%', '60%'],
								itemStyle: {  
									normal: {  
									 label:{  
											show: true,  
											formatter: function(param) {
												 return param.name + param.value + "个" + ':\n' + Math.round(param.percent) + '%';
											},
											textStyle : {
												fontWeight : 'bolder'
											}
										}   
									},
								 },    
								data:[
									{value:335, name:'危险'},
									{value:310, name:'故障'},
									{value:234, name:'正常'},
									{value:135, name:'未知'},
								], 
								color:['#FF5722','#F7B824','#5FB878','#d2d2d2','#2F4056']
							}
						]
					};
		
				// 使用刚指定的配置项和数据显示图表。
				myChart.setOption(option);


				// 基于准备好的dom，初始化echarts实例
				var myChart = echarts.init(document.getElementById('main2'));
		
				// 指定图表的配置项和数据
				var option = {
						title: {
									text: '80台',
									subtext: '设备',
									x: 'center',
									y: 'center',
									itemGap: 10,
									textStyle : {
										color : '#01AAED',
										fontFamily : '微软雅黑',
										fontSize : 24,
										fontWeight : 'bolder'
									}
								},
						tooltip : {
									trigger: 'item',
									formatter: "{a} <br/>{b} : {c} ({d}%)"
								},
						series: [
							{
								name:'访问来源',
								type:'pie',
								radius: ['40%', '60%'],
								itemStyle: {  
									normal: {  
									 label:{  
											show: true,  
											formatter: function(param) {
												 return param.name + param.value + "个" + ':\n' + Math.round(param.percent) + '%';
											},
											textStyle : {
												fontWeight : 'bolder'
											}
										}   
									},
								 },    
								data:[
									{value:31, name:'危险'},
									{value:10, name:'故障'},
									{value:34, name:'正常'},
									{value:5, name:'未知'},
								], 
								color:['#FF5722','#F7B824','#5FB878','#d2d2d2','#2F4056']
							}
						]
					};
		
				// 使用刚指定的配置项和数据显示图表。
				myChart.setOption(option);				
			</script>
			
			<script type="text/javascript" src="../static/plugins/layui/layui.js"></script>
			<script>
				layui.use('element', function() {
					var element = layui.element(); //导航的hover效果、二级菜单等功能，需要依赖element模块
	
				});
			</script>
		</div>
	</body>

</html>