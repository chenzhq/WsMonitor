<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<html>
<head>
	<meta charset="UTF-8">
	<title>监控系统</title>
	<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
	<script src="../static/js/semantic.js" th:src="@{/js/semantic.js}"></script>
	<link rel="stylesheet" href="../static/css/semantic.css" th:href="@{/css/semantic.css}"  />
	<link rel="stylesheet" href="../static/css/icon.css" th:href="@{/css/icon.css}" />
	<!-- 引入 echarts.js -->
	<script src="../static/js/echarts.min.js"></script>
	<!-- 引入 ajax异步请求，模拟服务器地址 -->
	<script src="http://rapapi.org/rap.plugin.js?projectId=19544"></script>
</head>

<body >
<div class="ui three column grid">
	<div class="column">
		<div  class="ui segment"   style="padding-top : 0px;padding-bottom: 0px">
			<h4>业务系统</h4>
			<div class="ui divider"></div>
			<div id="main0" style="height: 200px"></div>
		</div>
	</div>
	<div class="column">
		<div class="ui segment"   style="padding-top : 0px;padding-bottom: 0px">
			<h4>监控点</h4>
			<div class="ui divider"></div>
			<div id="main1" style="height: 200px"></div>
		</div>
	</div>
	<div class="column">
		<div class="ui segment"  style="padding-top : 0px;padding-bottom: 0px">
			<h4>设备</h4>
			<div class="ui divider"></div>
			<div id="main2" style="height: 200px"></div>
		</div>
	</div>
</div>
<div class="ui segment">
	<h3>
		<i class="bar chart icon"></i>
		最近的20个问题
	</h3>
	<table class="ui small table">
		<thead>
		<tr >
			<th>主机</th>
			<th>问题</th>
			<th>上次修改于</th>
			<th>历时</th>
			<th>确认</th>
		</tr></thead>
		<tbody>
		<tr >
			<td>
				<div class="ui ribbon label">主机1</div>
			</td>
			<td>主机1内存使用率超过90%</td>
			<td>2017-4-27 15:33:20</td>
			<td><p>2天4小时50分</p></td>
			<td><button >不</button></td>
		</tr>
		<tr >
			<td>主机1</td>
			<td>主机1内存使用率超过90%</td>
			<td>2017-4-27 15:33:20</td>
			<td><p>2天4小时50分</p></td>
			<td><button >不</button></td>
		</tr>
		<tr >
			<td>主机1</td>
			<td>主机1内存使用率超过90%</td>
			<td>2017-4-27 15:33:20</td>
			<td><p>2天4小时50分</p></td>
			<td><button >不</button></td>
		</tr>
		<tr >
			<td>主机1</td>
			<td>主机1内存使用率超过90%</td>
			<td>2017-4-27 15:33:20</td>
			<td><p>2天4小时50分</p></td>
			<td><button >不</button></td>
		</tr>
		<tr>
			<td>主机1</td>
			<td>主机1内存使用率超过90%</td>
			<td>2017-4-27 15:33:20</td>
			<td><p>2天4小时50分</p></td>
			<td><button >不</button></td>
		</tr>
		</tbody>
		<tfoot>
		<tr><th colspan="5">
			<div class="ui mini right teal floated pagination menu">
				<a class="icon item">
					<i class="left chevron icon"></i>
				</a>
				<a class="item">1</a>
				<a class="item">2</a>
				<a class="item">3</a>
				<a class="item">4</a>
				<a class="icon item">
					<i class="right chevron icon"></i>
				</a>
			</div>
		</th>
		</tr></tfoot>
	</table>
</div>

<script type="text/javascript">
    var myChart = echarts.init(document.getElementById('main0'));
    var onemyChart = echarts.init(document.getElementById('main1'));
    var twomyChart = echarts.init(document.getElementById('main2'));
    // 指定图表的配置项和数据
    var option = {
        title: {
            text: '10个',
            subtext: '业务系统 ',
            x: 'center',
            y: 'center',
            itemGap: 10,
            textStyle : {
                color : '#01AAED',
                fontFamily : '微软雅黑',
                fontSize : 24,
                fontWeight : 'bolder'
            }
        },
        tooltip : {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        series: [
            {
                name:'访问来源',
                type:'pie',
                radius: ['52%', '82%'],
                itemStyle: {
                    normal: {
                        label:{
                            show: true,
                            formatter: function(param) {
                                return param.name + param.value + "个" + ':\n' + Math.round(param.percent) + '%';
                            },
                            textStyle : {
                                fontWeight : 'bolder'
                            }
                        }
                    },
                },
                data: [
                ],
                color:['#FF5722','#F7B824','#5FB878','#d2d2d2','#2F4056']
            }
        ]
    }

    onemyChart.showLoading();

    $.ajax({
        type: "post",
        async: true,
        url: "/host/count",
        data: {},
        dataType: "json",
        success: function (result) {
            onemyChart.hideLoading();
            var data=result.data;
            var dataList=data.stateNum;
            var total=data.totalNum+"个";
            if(dataList){
                option.title.text = total;
                option.series[0].data = dataList;
                // 重写指定图表的配置项和数据
                myChart.setOption(option);
                onemyChart.setOption(option);
                twomyChart.setOption(option);
            }
        },
        error: function (errorMsg) {
            alert("图表请求数据失败!");
        }
    })
</script>
</div>
</body>
</html>